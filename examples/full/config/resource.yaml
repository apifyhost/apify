listeners:
  - name: main-http
    port: 3000
    ip: 0.0.0.0
    protocol: HTTP

apis:
  - path: ./openapi/items.yaml
    datasource: postgres1
    listeners: [main-http]
  - path: ./openapi/items_oauth.yaml
    datasource: postgres1
    listeners: [main-http]
  - path: ./openapi/orders.yaml
    datasource: postgres1
    listeners: [main-http]
  - path: ./openapi/users.yaml
    datasource: postgres1
    listeners: [main-http]

auth:
  - name: default-api-keys
    type: api-key
    enabled: true
    config:
      source: header
      key_name: X-API-KEY
      consumers:
        - name: default
          keys:
            - dev-key-123
            - e2e-test-key-001

  - name: keycloak
    type: oidc
    enabled: true
    config:
      issuer: "${KEYCLOAK_URL:http://localhost:8080}/realms/${KEYCLOAK_REALM:apify}"
      client_id: "${KEYCLOAK_CLIENT_ID:apify-test-client}"
      client_secret: "${KEYCLOAK_CLIENT_SECRET:apify-test-secret}"
      audience: "apify-api"
      introspection: true

datasource:
  sqlite1:
    driver: sqlite
    database: ./apify.sqlite
    max_pool_size: 5

  postgres1:
    driver: postgres
    host: postgres
    port: 5432
    user: apify
    password: apify_test_password
    database: apify_e2e
    ssl_mode: disable
    max_pool_size: 10
