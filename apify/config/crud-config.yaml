listeners:
  - port: 3000
    ip: 0.0.0.0
    protocol: HTTP
    routes:
    - name: api
      matches:
      - path:
          path_prefix: /
        method: GET

# Database configuration
database:
  host: localhost
  port: 5432
  user: postgres
  password: postgres
  database: apify_db
  ssl_mode: prefer
  max_pool_size: 10

# OpenAPI specification for CRUD operations
openapi:
  spec:
    openapi: "3.0.0"
    info:
      title: "Apify CRUD API"
      version: "1.0.0"
      description: "Auto-generated CRUD API"
    paths:
      /users:
        get:
          summary: "List all users"
          operationId: "listUsers"
          responses:
            "200":
              description: "List of users"
              content:
                application/json:
                  schema:
                    type: array
                    items:
                      $ref: "#/components/schemas/User"
        post:
          summary: "Create a new user"
          operationId: "createUser"
          requestBody:
            required: true
            content:
              application/json:
                schema:
                  $ref: "#/components/schemas/NewUser"
          responses:
            "201":
              description: "User created"
              content:
                application/json:
                  schema:
                    $ref: "#/components/schemas/User"
      /users/{id}:
        get:
          summary: "Get user by ID"
          operationId: "getUser"
          parameters:
            - name: id
              in: path
              required: true
              schema:
                type: string
          responses:
            "200":
              description: "User found"
              content:
                application/json:
                  schema:
                    $ref: "#/components/schemas/User"
            "404":
              description: "User not found"
        put:
          summary: "Update user"
          operationId: "updateUser"
          parameters:
            - name: id
              in: path
              required: true
              schema:
                type: string
          requestBody:
            required: true
            content:
              application/json:
                schema:
                  $ref: "#/components/schemas/UserUpdate"
          responses:
            "200":
              description: "User updated"
              content:
                application/json:
                  schema:
                    $ref: "#/components/schemas/User"
        delete:
          summary: "Delete user"
          operationId: "deleteUser"
          parameters:
            - name: id
              in: path
              required: true
              schema:
                type: string
          responses:
            "200":
              description: "User deleted"
              content:
                application/json:
                  schema:
                    type: object
                    properties:
                      message:
                        type: string
                      affected_rows:
                        type: integer
    components:
      schemas:
        User:
          type: object
          properties:
            id:
              type: string
            name:
              type: string
            email:
              type: string
            created_at:
              type: string
              format: date-time
        NewUser:
          type: object
          required:
            - name
            - email
          properties:
            name:
              type: string
              minLength: 1
            email:
              type: string
              format: email
        UserUpdate:
          type: object
          properties:
            name:
              type: string
              minLength: 1
            email:
              type: string
              format: email
  validation:
    strict_mode: true
    validate_request_body: true
    validate_response_body: false
