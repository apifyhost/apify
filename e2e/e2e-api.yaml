openapi:
  spec:
    openapi: "3.0.0"
    info:
      title: "E2E Test API"
      version: "1.0.0"
      description: "API for end-to-end testing"
    
    x-table-schemas:
      - table_name: "items"
        columns:
          - name: "id"
            column_type: "INTEGER"
            nullable: false
            primary_key: true
            unique: false
            auto_increment: true
          - name: "name"
            column_type: "TEXT"
            nullable: false
            primary_key: false
            unique: false
            auto_increment: false
          - name: "description"
            column_type: "TEXT"
            nullable: true
            primary_key: false
            unique: false
            auto_increment: false
          - name: "price"
            column_type: "REAL"
            nullable: true
            primary_key: false
            unique: false
            auto_increment: false
          - name: "created_at"
            column_type: "TIMESTAMP"
            nullable: false
            primary_key: false
            unique: false
            auto_increment: false
            default_value: "CURRENT_TIMESTAMP"
        indexes: []
    
    paths:
      /items:
        get:
          operationId: listItems
          summary: "List all items"
          x-table-name: "items"
          x-modules:
            access: ["key_auth"]
          responses:
            "200":
              description: "List of items"
        
        post:
          operationId: createItem
          summary: "Create a new item"
          x-table-name: "items"
          x-modules:
            access: ["key_auth"]
          requestBody:
            required: true
            content:
              application/json:
                schema:
                  type: object
                  required: ["name"]
                  properties:
                    name:
                      type: string
                    description:
                      type: string
                    price:
                      type: number
          responses:
            "200":
              description: "Item created"
      
      /items/{id}:
        get:
          operationId: getItem
          summary: "Get item by ID"
          x-table-name: "items"
          x-modules:
            access: ["key_auth"]
          parameters:
            - name: id
              in: path
              required: true
              schema:
                type: integer
          responses:
            "200":
              description: "Item details"
            "404":
              description: "Item not found"
        
        put:
          operationId: updateItem
          summary: "Update an item"
          x-table-name: "items"
          x-modules:
            access: ["key_auth"]
          parameters:
            - name: id
              in: path
              required: true
              schema:
                type: integer
          requestBody:
            required: true
            content:
              application/json:
                schema:
                  type: object
          responses:
            "200":
              description: "Item updated"
            "404":
              description: "Item not found"
        
        delete:
          operationId: deleteItem
          summary: "Delete an item"
          x-table-name: "items"
          x-modules:
            access: ["key_auth"]
          parameters:
            - name: id
              in: path
              required: true
              schema:
                type: integer
          responses:
            "200":
              description: "Item deleted"
            "404":
              description: "Item not found"
      
      /health:
        get:
          operationId: healthCheck
          summary: "Health check endpoint"
          responses:
            "200":
              description: "Service is healthy"
